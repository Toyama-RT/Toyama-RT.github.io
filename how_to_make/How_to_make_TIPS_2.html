<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"> 
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z7DXKP3EBK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z7DXKP3EBK');
</script>

  <script type="text/javascript" src="../sh/scripts/shCore.js"></script>
  <script type="text/javascript" src="../sh/scripts/shBrushXml.js"></script>
  <script type="text/javascript" src="../sh/scripts/shBrushPlain.js"></script>
  <script type="text/javascript" src="../sh/scripts/shBrushJScript.js"></script>
  <script type="text/javascript" src="../sh/scripts/shBrushVb.js"></script>
  <link type="text/css" rel="stylesheet" href="../sh/styles/shCoreDefault.css" />
  <script type="text/javascript">SyntaxHighlighter.all();</script>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>富山県高志リハビリ病院　しゃべる文字盤のつくりかた　TIPS　第2回</title>

 <style type="text/css">
<!--
P	{
	LINE-HEIGHT: 1.5
	}
-->
  </style>
</head>

<body style="color: black; background-color: white;" alink="#800080" link="#0000ff" vlink="#0080ff">
<p align="center">
<font size="3">
<font color="#ff0000">かならずお読みください → </font>
<a href="../cyuui.html" target="_self"><img alt="注意事項" src="../cyuuijikou.gif" border="0" height="29" width="78" /></a>
</font>
</p>

<blockquote>
  <p align="center"><font size="5">しゃべる文字盤のつくりかた<br />
</font></p>
<p align="center"><font size="5">TIPS_2　音をならす方法</font></p>

<p align="center"><img alt="Win７サウンドアイコン" src="img/windows-7-audio-icon.png"/></p>

  <hr align="center" size="3" width="80%" />

<p>
コミュニケーションエイドの取り組みは操作スイッチ選びから始まります。
スイッチを選ぶ際のポイントは以下のようになります。<br/>
１　操作が楽にできるか<br />
２　十分長い時間操作を維持できるか<br />
３　タイミングよく操作できるか<br />
</p><p>
例えばスキャン入力方式のコミュニケーションエイドは動きや力の量が十分でないところを動作の質でカバーするという基本原理です。そのため使いこなすには機敏さやタイミングの良さがある程度必要になります。ところがなかには普通にスイッチを使えるけれど、タイミングよくやろうとすると緊張？のためかうまくいかないひともおられますので注意が必要です。
</p><p>
このような場合は、スキャン時間間隔を大きく（ゆっくり動くようにする、これについてはＴＩＰＳ４で解説する予定です）するほかに、スキャンのタイミングに合わせて音を出すとうまくいきやすくなります。音を利用してタイミングを合わせやすくする例として、時報の予鈴、（ドドドソーの3つのド）、スタート号砲まえの『位置について、用意』などがあります。
</p><p>
この他、しびれなどによりスイッチの手応えがはっきりしない、押したか押してないかご自分でもよくわからないこともあります。自分では押したはずなのに押せていない、押していないはずなのに押してしまった。一回押すところを二回押してしまった。これらがあまりに多いと、コミュニケーションエイドを使う練習がうまく進まなくなります。教えている方も辛いですが、取り組んでいる方もかなり辛い思いをされます。ついつい前向きな気持ちが消えそうになることもありますので注意が必要です。
この様な場合にも、スイッチに合わせて音が出ると意識と動作のギャップを理解しやすくなります。
</p><p>
動作に余裕がある場合には、操作音やクリック感の大きなスイッチを選びたいところですが、力が足りない人にはそのようなスイッチを操作できないことも多いようです。そこでスイッチは操作しやすさを優先して選び、操作音はソフトウエアで出して知らせることで、間違いや勘違いを防ぎ、操作方法の理解を助ける効果をねらうことができます。

もし音が聞こえにくい場合には、画面表示（例えば画面の明滅）で視覚的に知らせるとよいかもしれません。その場合TIPS1の説明が役に立つでしょう。<br />
</p><p>
TIPS2では、このような用途に利用する、音について説明します。

</p>
<hr align="center" size="3" width="80%" />
<p>
基本的にExcelVBAそれ自身には音を出す機能はありません。<br />

しかし、『VBA　音を鳴らす』（複数のキーワードの間にスペースを入れると、それらすべてのキーワードが含まれる項目の検索が可能）と検索すると、いくつかの方法があることがわかります。しゃべる文字盤ではそれらの方法のひとつ、WindowsAPI関数（Windowsが備えている機能）のひとつPlaySoundを利用してExcelからwavファイルを再生し音を鳴らしています。

wavファイルは音が記録されたファイルです。マイクとWindowsに付属のアクセサリ、サウンドレコーダを使えば録音してwavファイルを作れます。このようにすると比較的簡単にさまざまな音が自由に再生できるようになります。（wavファイルの作り方は、<a href="../mojiban/mojiban_onsei.html" target=”_blank”>こちら</a>も参考になさってください）<br/>
また、WindowsAPIにはこの他にも機能がいろいろありますので応用はさらに広がるでしょう。
</p>
<hr align="center" size="3" width="80%" />
<p>
PlaySoundなどのWindowsAPI関数を使うためには、VBAのプログラムの文頭にそのことを書いておきます。これをモジュール宣言といいます。しゃべる文字盤ではこのようにWindowsの機能をエクセルから利用しています。
</p>

<pre class="brush: vb;">
Declare Function PlaySound Lib "winmm.dll" Alias "PlaySoundA" _
(ByVal lpszName As String, ByVal hModule As Long, ByVal dwFlags As Long) As Long

.....中略.....

PlaySound "c:\Windows\Media\Windows Pop-up Blocked.wav", 0, 1

</pre>
<p>
<b>1-2行</b>　PlaySoundの宣言文です。<br />

<b>6行</b>　　文中での利用例です。Ｗｉｎｄｏｗｓのシステム音『ポッ』を非同期で鳴らします。<br />

使い方<br />
PlaySound 引数1，　引数2，　引数3<br />
引数1　：　wavファイル名フルパスで指定<br />
引数2　：　通常0<br />
引数3　：　0　同期：音が出ている間プログラムが停止し音が止まると再開します。他の操作が一切できません。<br />
　　　　　1　非同期：音が出ている間でもプログラムが動きます。<br />
　　　　　8　音を繰り返し出します。<br />
　　　　160　音を止めます。<br />
この文ではごく概要のみ説明しました。もっと詳しく知りたいときは、VBA　PlaySound　で検索してください。
</p>
<hr align="center" size="3" width="80%" />
<p>
まとめ<br />
今回は、WindowsAPI関数を利用して、エクセルからWindowsの機能を利用する事例として、音を鳴らす方法をご紹介しました。
この方法で、短い音から長い音、音楽、歌、物語、台詞、言葉などが出せるようになります。
コミュニケーションエイドでは、音の用途はごく限られていますが、もしVOCAのようなものを作る際にこの様な方法が使えると思います。<br />

しゃべる文字盤、TIP編の二番目は、テーマが　耳　でした。
</p>

<hr align="left" size="3" width="100%" /> 
<font size="2">2014/6/14　公開 </font> 
<a href="../index.html" target="_self"><p align="center">研究企画課リハ工学科にもどる</p></a>

</blockquote>
</body></html>
