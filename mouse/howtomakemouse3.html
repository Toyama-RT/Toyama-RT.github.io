<!DOCTYPE html>
<html lang="ja"><head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-82832782-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-82832782-3');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z7DXKP3EBK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z7DXKP3EBK');
</script>

  <meta content="text/html; charset=utf-8" http-equiv="content-type">

  
  <script type="text/javascript" src="../sh/scripts/shCore.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushXml.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushPlain.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushJScript.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushVb.js"></script>
  
  <link type="text/css" rel="stylesheet" href="../sh/styles/shCoreDefault.css">

  
  <script type="text/javascript">SyntaxHighlighter.all();</script>
  <title>不自由をもつ人のためのマウスつくり３｜富山県リハ病院こども支援センター</title>
  
  <style type="text/css">
<!--
      
p	{
      font-size: 20px;
      line-height : 1.75 ;
      margin: 15px 100px 15px 100px;
	}
h1 {
    text-align: center;
    }
h2 {
    text-align: left;
      margin-left: 100px;
    }
h3 {
    text-align: left;
      margin-left: 100px;
    }
h4 {
    text-align: left;
      margin-left: 120px;
    }
pre {
    font-size: 20px;
    margin: 5px 100px 15px 100px;
    }
address{
	margin:5px 100px 15px 100px;
}      
blockquote {
    position: relative;
      font-size: 20px;
      line-height : 1.5 ;
    padding: 5px 150px 8px 100px;
    box-sizing: border-box;
    font-style: italic;
}
ol {
}
ul {
}
li {
  margin-top: 5px; /* 上余白指定 */
  margin-bottom: 5px; /* 下余白指定 */
  margin-left: 100px; /* 左余白指定*/
  margin-right: 100px; /* 右余白指定 */
  font-size: 20px; /*リストのフォントの大きさ*/
}
button{
  margin-bottom:1rem;
  width:150px;
  height:100px;
}

span.samples {font-size: small; }
.syntaxhighlighter {
  width: 80% !important;
  margin: 1em 100px 1em 100px !important;
  position: relative !important;
  overflow: auto !important;
  font-size: 1.3em !important;
}

    #text1 {
        width: 50%;
        height: 3em;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 3px;
        margin-bottom: 10px;
        font-size: 1.4em;
        font-weight: 700;
    }
    #btn1 {
        background: -webkit-linear-gradient(top,#008dfd 30%,#0370ea 100%);
        color: white;
        text-shadow: 1px 1px 1px #076bd2;
        border-radius: 3px;
        border: 1px solid #076bd2;
        padding: 2px 25px;
        font-weight: 700;
        font-size: 20px;
    }
    #selectVoice1 {
        width: 200px;
        font-weight: 700;
        font-size: 20px;

    }
    #text2 {
        width: 50%;
        height: 3em;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 3px;
        margin-bottom: 10px;
        font-size: 1.4em;
        font-weight: 700;
    }
    #btn2 {
        background: -webkit-linear-gradient(top,#008dfd 30%,#0370ea 100%);
        color: white;
        text-shadow: 1px 1px 1px #076bd2;
        border-radius: 3px;
        border: 1px solid #076bd2;
        padding: 2px 25px;
        font-weight: 700;
        font-size: 20px;
    }
    #selectVoice2 {
        width: 200px;
        font-weight: 700;
        font-size: 20px;

    }
    #text3 {
        width: 50%;
        height: 3em;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 3px;
        margin-bottom: 10px;
        font-size: 1.4em;
        font-weight: 700;
    }
    #btn3 {
        background: -webkit-linear-gradient(top,#008dfd 30%,#0370ea 100%);
        color: white;
        text-shadow: 1px 1px 1px #076bd2;
        border-radius: 3px;
        border: 1px solid #076bd2;
        padding: 2px 25px;
        font-weight: 700;
        font-size: 20px;
    }
    #selectVoice3 {
        width: 200px;
        font-weight: 700;
        font-size: 20px;
    }


-->
  </style>

</head><body>
<p align="center"><font size="5"><font size="5"><font size="3"><font color="#ff0000">かならずお読みください</font>→<a href="../cyuui.html" target="_self"><img alt="注意事項" src="../cyuuijikou.gif" border="0" height="29" width="78"></a></font></font></font></p>

<h1>不自由をもつ人のためのマウス作り　３</h1>
<h1>不自由をカバーするにはなにをしたらいいのか</h1>

<div style="text-align: center;"><img alt="ふるえる絵" src="img/sick_furue.png" >
<br>手が震えると検索したらこんな画像が<br>Copyright いらすとや
</div>

<h2>０　はじめに</h2>
<p>
不自由をもつ人のためのマウス作りと題していますが、自由とは不自由とは何でしょう、できるとかできないは何でしょう。随意とか不随意とは何でしょう。今回はこれらについて考えてみましょう。
</p><p>
スイッチ操作やコミュニケーションエイドに関係する集まりが各地で色々あります。そこに参加すると様々なお話を聞くことができます。（まれにとても少ないこともありますがそれはさておき）そこではうまくいかないとかできないとかの話がとても多いのは、ある意味では当然のことでしょう。参加者のみなさんはそこに困っているから参加しているのですから。しかし残念ながらうまくいかない理由や原因や解決方法について話が進むことはあまりありません。（正しくはほとんどありません）
</p><p>
うまくいかない事例紹介にも意味も価値もないわけではありませんが、こればかりが続くとなんとも変なこころもちになります。気を取り直してまた別の会に参加するとなぜか前の会と同じようなことになったりしてまた変なこころもちになります。どうもこの問題を多くの人々に知らせることにばかり力が入っているように思えてきます。環境なんとかや自然なんとかもそうですが、大勢集まってもできるものはできるし、できないものはできません。大切なのは原理を理解し原因を明らかにして、根拠のある対策を行うことだと思うのですがどうでしょうか。
</p><p>
そこでスイッチ操作がうまくいかない場面について、その理由を考え対策することについて考えてみることにします。
</p>
<h2>１　不自由のサンプル　AutoHotkey</h2>
<p>
前回はモーメンタリ動作とオルタネイト動作について説明しました。その際に使用したサンプルのコードをもう一度見てみよう。
</p><p>
mouse2.ahk
<pre class="brush: js;">
Speed:=20

Up::
X:=0
Y:=-2
Sleep, 250
Loop
{
MouseMove, X, Y, Speed, R
if GetKeyState("Up", "P") = 1
Return
}
return

Down::MouseMove, 0, 2, 50, R
Left::MouseMove, -2, 0, 50, R
Right::MouseMove, 2, 0, 50, R
</pre>
</p><p>
このサンプルは、上矢印キーを押せばマウスカーソルが上方向に動き、再度上矢印キーを押せば停止するものです。
</p><p>
この6行目で、Sleep, 250　として250ミリ秒間停止させています。
</p><p>
実ははじめはこの行はありませんでした。しかし試運転の結果この行を追加することにしました。
</p><p>
このサンプルは、上矢印キーを押したとき3行目から動作が開始し、行に記された仕事を次々とこなしていきます。そしてLoopで8-12行を繰り返します。9行目でマウスカーソルを動かしています。10行目で上矢印キーが押されたかどうかを判定しもし押されていたら、11行目でLoopから抜けてマウスの動きも止まります。
</p><p>
さてはじめ6行目がない状態で試してみました。ところが上矢印キーを押してもマウスカーソルは動きません。何回やってもおなじです。プログラム自体は途中で止まっていません。きちんと終了しています。そのうち一回やることにほんの少し動いていることに気がつきました。そうです。私が上矢印キーをポンと押す瞬間に2行、3行と進んで指が離れるまえに10行目で「押している」と判断し停止していたのです。その間に9行目で2dotだけ動いていたのです。5行目に注目ください。
</p><p>
このトラブルの原因は、「押したあと指を離すのが遅い」ことでした。そこでまず十分神経を集中して可能な限り押し時間を短くするようにやってみました。しかしうまくいくのは10回に1回くらいでそれもかなり疲れますので実用的ではありません。しかし原因がはっきりしていますので対策も明確です。すなわち6行目と10行目の間の時間を長くすればいいのです。これにはSleepコマンドを使います。ミリ秒単位で停止を指定できます。100ミリ秒で試したところ随分改善しました。さらに250ミリ秒にするとかなりのんびり押しても問題ありませんでした。さらにこのような操作でミリ秒単位の無駄時間が生じてもとくに問題はありません。そこで、6行目にSleep, 250　を入れることにしました。これで改善はできました。
</p><p>
しかし「押したあと指を離すのが遅い」のでうまくいかないという話をきいたことはありませんか？そうです不自由をもつ人でも同じ理由でうまくいかないことがよくあるのです。今回偶然、不自由をもつ人のスイッチ操作での苦労を私も体験することができました。『そうかこんなきもちなのか』。この分野に関心のある方々には一度体験されることをお勧めします。
</p><p>
不自由のあるなしで、やれ指の動きが早いとか遅いとか言っても、コンピュータの速さと比べれば大した違いはありません。もし二倍時間がかかるとしても、原理的にはSleep, 500 で防止できます。このように仕組みがわかって原因もはっきりすれば、効果的な対策を立てることも、手直しして使うことも可能になります。
</p><p>
ただしこれは遅れ時間がほぼ均一なときに限ります。なかには時々スイッチをおしたまま数秒以上固まってしまう人もいます。このような場合はスイッチから手が離せるようになるまで動作を止めて待っているようにするのがいいでしょう。方法は色々考えられますが、例えばこのようなやり方はいかがでしょうか？
</p><p>
mouse3.ahk
<pre class="brush: js;">
Speed:=20

Up::
X:=0
Y:=-2
Loop
{
if GetKeyState("Up", "P") = 0
Break
Sleep, 100
}
Loop
{
MouseMove, X, Y, Speed, R
if GetKeyState("Up", "P") = 1
Y:=0
if (GetKeyState("Up", "P") = 0) and (Y = 0)
Break
}
return

Down::MouseMove, 0, 2, 50, R
Left::MouseMove, -2, 0, 50, R
Right::MouseMove, 2, 0, 50, R
</pre>
</p><p>
説明<br>
前回のサンプルに改良を加えています。<br>
3-5行　上矢印キーを押下すると、x=0、y=-2に指定します<br>
6-11行　つぎにこのループに入ります。上矢印キーを離さないとここから抜けられません
<br>
12-19行　loopでこの間の処理を繰り返します<br>
14行　指定されたx,y,speedでマウスカーソルを移動します<br>
15行　上矢印キーが押されると速度Yがゼロになります<br>
17-18行　上矢印キーが離されるとループから抜けます　あと省略<br>

</p><p>
実際に試してみたい方は、
<a target="_blank" href="http://www.toyama-reha.or.jp/techno/engineering/mouse/mouse3.exe">常駐型実行ファイル、mouse3.exe　をこちらから</a>
ダウンロードしてください。ダブルクリックで動作を開始します。終了するときはタスクトレイ（通知領域、画面右下の部分）のＨのアイコンを右クリックしてEXITしてください。
</p><p>
スイッチ操作が機敏に押したり離したりが難しい場合の対策はこのようにすればよろしいでしょう。
</p>
<h2>３　手が震える場合</h2>
<p>
このほかの不都合として、震えのためスイッチ操作の際に、オンオフオンオフ。。。。。と繰り返してしまうことがあります。こちらはチャタリングと言います。これは健常者でも発生します。このためスイッチを設計する際は、バネ、接点、摩擦粘性など考慮してチャタリングを防止するようにします。しかしこれは普通の人の場合が対象です。不自由を持つ人の場合は震えの種類も大きさも幅広いですから、スイッチなどのものを作るよりも、ソフトで対応するのが手間もお金も節約できるだろうと思います。
</p><p>
震えがある場合の基本的対応として、一定時間オンが続いたらオンと同じく一定時間オフが続いたらオフと判断しそれ以外は無視するのが基本です。使用する人の震えに合わせて調整するといいでしょう。一例を次に示します。
</p><p>
mouse4.ahk
<pre class="brush: js;">
Speed:=100
X:=0
Y:=0
A:=0
Loop
{
if GetKeyState("Up", "P") = 1
Count++
Else
Count:=0
if (count=10 and A=0)
{
A:=1
X:=0
Y:=-2
}
Else if (count=10 and A=1)
{
A:=0
X:=0
Y:=0
}
MouseMove, X, Y, Speed, R
Sleep, 100
}
Return

Down::MouseMove, 0, 2, 50, R
Left::MouseMove, -2, 0, 50, R
Right::MouseMove, 2, 0, 50, R
</pre>
</p><p>
説明<br>
今回は起動すると即プログラムが動き始めます。一秒間押し続けるとマウスカーソル動き始め、一秒間押し続けると止まります。
全体が大きなループになっています。<br>
7-10行　上矢印キーを押していると、Countが１増えます。離していると0になります。<br>
11-16行　Countが10で（1秒経過）停止しているとき（A=0）速度（XとY）に値を入れ、Aを1に変更します。<br>
17-22行　Countが10で（1秒経過）動いているとき（A=1）速度（XとY）にゼロを入れ、Aを0に変更します。<br>
23行　そのときのXとYの値でマウスカーソルを動かします。<br>
24行　100ミリ秒停止します。このループ10回で1秒になります。<br>
あと省略
</p><p>
実際に試してみたい方は、
<a target="_blank" href="http://www.toyama-reha.or.jp/techno/engineering/mouse/mouse4.exe">常駐型実行ファイル、mouse4.exe　をこちらから</a>
ダウンロードしてください。ダブルクリックで動作を開始します。終了するときはタスクトレイ（通知領域、画面右下の部分）のＨのアイコンを右クリックしてEXITしてください。
</p>
<h2>４　まとめ</h2>
<p>
今回はAutoHotkeyを使って不自由をもつ人がスイッチ操作で遭遇しがちな問題とその対策について考えてみました。AutoHotkeyはもともとWindowsでホットキー（ショートカットキーともいいます）を作るためのツールですが、使いようによっては不自由をもつ人がパソコンを操作する際の支援にもずいぶん役に立つようです。また手作りスイッチと違い、作っては壊しの試行錯誤もやりやすいことがわかりました。このようなツールをもっと広い用途につかっていきたいと思います。
</p><p>
また、AutoHotkeyには機器操作支援やコミュニケーション支援にあたる支援者の学習教材としての使い道もあるようです。かなり手軽ですし無料ですし、事例もサンプルもたくさんあります。また実行ファイルを作って配布しやすい特徴もあります。GNU GPLv2. ライセンスですのでまあ気楽に自由に何でもできます。今回の試みでも、スイッチ操作で不自由をもつ人の困難は程度の違いはあるものの普通の人々も同様にもっていることがわかりました。ただ普通の人たちへの対策は身の回りにあふれていますが、少数者への配慮は大量生産では省略されています。その部分を作って付け足せば問題の解決に近づくわけです。
</p><p>
最後にこのようなソフトを自作する意味について考えて見ましょう。Windowsにはテンキーで操作するマウスが『簡単操作』にすでに存在します。それでも同じ目的で似たものを作るのはなぜでしょう。
</p><p>
プログラムを作るには中の仕組みをひとつひとつ理解しなくてはなりません。反対に考えるとプログラムを作ると中の仕組みがわかってきます。作ったプログラムがうまく動くように改善できるのも中の仕組みがわかっているからです。そしてうまくいかない人がうまくできるように改善するときも中の仕組みがわかっていないとうまく修正できません。それどころか中の仕組みがわからないとその人がどうしてうまくいかないかも容易に理解できないでしょう。このような理由から自分でプログラムを作ろうとしているのです。また同じ理由でこのページではどう作ったのか中身をお見せしています。
</p><p>
市販品を次々と試しているがどれもうまくいかないという人がいます。でも考えてみてください。竹取物語ではどの縁談もうまくいきませんでしたがそれには原因がありました。原因を無視していたらどれだけやってもまとまる話もまとまらないのは無理もありませんね。
</p>


<h2>参考URL</h2>

<p>操作スイッチの適合関係
<ul>
  <li>重度障害者用 意思伝達装置操作スイッチ 適合マニュアル<br>
<a target="_blank" href="https://www.amazon.co.jp/重度障害者用-意思伝達装置操作スイッチ-適合マニュアル-日向野-和夫/dp/4895905772">https://www.amazon.co.jp/重度障害者用-意思伝達装置操作スイッチ-適合マニュアル-日向野-和夫/dp/4895905772</a></li>
  <li>マイスイッチ<br>
<a target="_blank" href="https://myswitch.jp/">https://myswitch.jp/</a></li>

</ul>

<p>AutoHotkey　関係
<ul>
  <li>AutoHotkey　（本家　英語です）ダウンロードはこちらから<br>
<a target="_blank" href="https://www.autohotkey.com/">https://www.autohotkey.com/</a></li>

  <li>AutoHotkey　WIKI 　（日本の分家です）使い方マニュアル一覧<br>
<a target="_blank" href="http://ahkwiki.net/Top">http://ahkwiki.net/Top</a></li>

  <li>AutoHotkeyの評価・使い方 - フリーソフト100　基本的な解説　使い方など<br>
<a target="_blank" href="https://freesoft-100.com/review/autohotkey.html">https://freesoft-100.com/review/autohotkey.html</a></li>

  <li>AutoHotkey - ウィキペディア<br>
<a target="_blank" href="https://ja.wikipedia.org/wiki/AutoHotkey">https://ja.wikipedia.org/wiki/AutoHotkey</a></li>


</ul>

<p>GNU GPL v2.0　関係
<ul>
  <li>GNU GPL v2.0に関してよく聞かれる質問<br>
<a target="_blank" href="https://www.gnu.org/licenses/old-licenses/gpl-2.0-faq.ja.html">https://www.gnu.org/licenses/old-licenses/gpl-2.0-faq.ja.html</a></li>

</ul>

<hr style="width: 60%; height: 5%; color: black;">
<p><span class="samples">2019/12/13　公開<br>
</span></p>

<a href="../index.html" target="_self">
<p align="center">研究企画課リハ工学科にもどる</a>　←もくじはこちらです</p>

</body></html>
