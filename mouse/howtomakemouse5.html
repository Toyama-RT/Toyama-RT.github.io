<!DOCTYPE html>
<html lang="ja"><head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-82832782-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-82832782-3');
</script>

  <meta content="text/html; charset=utf-8" http-equiv="content-type">

  
  <script type="text/javascript" src="../sh/scripts/shCore.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushXml.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushPlain.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushJScript.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushVb.js"></script>
  
  <link type="text/css" rel="stylesheet" href="../sh/styles/shCoreDefault.css">

  
  <script type="text/javascript">SyntaxHighlighter.all();</script>
  <title>不自由をもつ人のためのマウスつくり５｜富山県リハ病院こども支援センター</title>
  
  <style type="text/css">
<!--
      
p	{
      font-size: 20px;
      line-height : 1.75 ;
      margin: 15px 100px 15px 100px;
	}
h1 {
    text-align: center;
    }
h2 {
    text-align: left;
      margin-left: 100px;
    }
h3 {
    text-align: left;
      margin-left: 100px;
    }
h4 {
    text-align: left;
      margin-left: 120px;
    }
pre {
    font-size: 20px;
    margin: 5px 100px 15px 100px;
    }
address{
	margin:5px 100px 15px 100px;
}      
blockquote {
    position: relative;
      font-size: 20px;
      line-height : 1.5 ;
    padding: 5px 150px 8px 100px;
    box-sizing: border-box;
    font-style: italic;
}
ol {
}
ul {
}
li {
  margin-top: 5px; /* 上余白指定 */
  margin-bottom: 5px; /* 下余白指定 */
  margin-left: 100px; /* 左余白指定*/
  margin-right: 100px; /* 右余白指定 */
  font-size: 20px; /*リストのフォントの大きさ*/
}
button{
  margin-bottom:1rem;
  width:150px;
  height:100px;
}

span.samples {font-size: small; }
.syntaxhighlighter {
  width: 80% !important;
  margin: 1em 100px 1em 100px !important;
  position: relative !important;
  overflow: auto !important;
  font-size: 1.3em !important;
}

    #text1 {
        width: 50%;
        height: 3em;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 3px;
        margin-bottom: 10px;
        font-size: 1.4em;
        font-weight: 700;
    }
    #btn1 {
        background: -webkit-linear-gradient(top,#008dfd 30%,#0370ea 100%);
        color: white;
        text-shadow: 1px 1px 1px #076bd2;
        border-radius: 3px;
        border: 1px solid #076bd2;
        padding: 2px 25px;
        font-weight: 700;
        font-size: 20px;
    }
    #selectVoice1 {
        width: 200px;
        font-weight: 700;
        font-size: 20px;

    }
    #text2 {
        width: 50%;
        height: 3em;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 3px;
        margin-bottom: 10px;
        font-size: 1.4em;
        font-weight: 700;
    }
    #btn2 {
        background: -webkit-linear-gradient(top,#008dfd 30%,#0370ea 100%);
        color: white;
        text-shadow: 1px 1px 1px #076bd2;
        border-radius: 3px;
        border: 1px solid #076bd2;
        padding: 2px 25px;
        font-weight: 700;
        font-size: 20px;
    }
    #selectVoice2 {
        width: 200px;
        font-weight: 700;
        font-size: 20px;

    }
    #text3 {
        width: 50%;
        height: 3em;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 3px;
        margin-bottom: 10px;
        font-size: 1.4em;
        font-weight: 700;
    }
    #btn3 {
        background: -webkit-linear-gradient(top,#008dfd 30%,#0370ea 100%);
        color: white;
        text-shadow: 1px 1px 1px #076bd2;
        border-radius: 3px;
        border: 1px solid #076bd2;
        padding: 2px 25px;
        font-weight: 700;
        font-size: 20px;
    }
    #selectVoice3 {
        width: 200px;
        font-weight: 700;
        font-size: 20px;
    }


-->
  </style>

</head><body>
<p align="center"><font size="5"><font size="5"><font size="3"><font color="#ff0000">かならずお読みください</font>→<a href="../cyuui.html" target="_self"><img alt="注意事項" src="../cyuuijikou.gif" border="0" height="29" width="78"></a></font></font></font></p>

<h1>不自由をもつ人のためのマウス作り　５</h1>
<h1>ゲームパッドでマウスを動かす</h1>

<div style="text-align: center;"><img alt="古いゲームパッド" src="img/gamepad.png" >
<br>丈夫で長持ち　古いゲームパッド
</div>

<h2>０　はじめに</h2>
<p>
不自由をもつ人のためのマウス作りも今回で５回目になります。これまでは主にAutoHotkeyを使ってマウスを操作するソフトウエアをどのように作るかの話をしてきました。今回はこれらのソフトウエアを操作する、言い換えれば人の意志をパソコンに伝える方法について話をします。
</p><p>
通常はキーボードやマウスを使ってパソコンを動かします。しかし不自由をもつためにそれがうまくいかない場合には別の方法を使います。最もよく使われるのがゲームパッドを使う方法です。このような話はこのサイトでも過去に何回か紹介しましています。またあちこちでよく行われている方法ですのでもうご存じの方もおられると思います。ですから今回はAutoHotkeyで作ったソフトを使う際の注意を中心にお話していきたいと思います。なおこの分野にあまり経験のない方は文末の関連するページ一覧を作りましたので、そちらもあわせてご覧になることをおすすめします。
</p>
<h2>１　準備　ゲームパッド</h2>
<p>
ゲームパッドはパソコン用ゲームソフトを楽しむための操作のためのコントローラです。（このページのトップ写真）通常パソコンのゲームソフトはキーボードで操作するように作られています。キーボードやマウスの代わりにこのようなコントローラを使うと操作しやすくなります。電器店、パソコンショップ、ゲームショップ、通販など様々なところで1000円程度から入手できます。また商品の性格上非常に丈夫でめったに壊れることはありません。これも現場ではありがたい特徴です。
</p>
<h2>２　準備　JoyToKey</h2>
<p>
ゲームパッドのボタンや十字キーの操作をキーボードやマウスの操作に置き換えるためのソフトを準備します。このソフトは主にパソコン用ゲームソフトを（キーボードではなく）ゲームパッドで遊ぶ目的で開発されました。しかしこれはキーボードやマウスが苦手だがゲームパッドならできる人がパソコンを操作する場合にも役に立ちます。この用途では、JoyToKeyやパッドdeマウスがよく知られています。またantimicroではWindowsのほかmacos、linuxにも対応しています。
</p><p>
関連するページの『ゲームパッドで作るパソコン入力装置』には、ゲームパッドに一般の外部スイッチで入力可能にする改造手順と、JoyToKeyの設定手順を説明しています。このような方法でパシフィックサプライのPPSやジェリービーンスイッチなども利用できるようになります。このページで説明している手順では、最後にF9キーをボタン1に設定していますが、今回はF9 キーの代わりに上矢印キーを設定して試運転をします。
</p>
<h2>３　試運転</h2>
<p>
前回ご紹介したサンプル、mouse6.ahk（実行ファイルはmouse6.exe）を使ってテストしてみました。ところが上矢印キーを使えば上右下左と動かせますが、JoyToKeyを上記のようにボタン1に上矢印キーを設定しゲームパッドのボタン1を押すと、動き始めはできるのですがうまく停止ができません。まるで動かないわけでもありませんがまだ未知の問題があるようで改善が必要な様です。
</p><p>
そこでエクセルで動くしゃべる文字盤を作ったときも、数多い（ものすごく多いです）エクセルのショートカットキーを避けてF9キーにしたことを思い出しました。またある人と別の相談をしているときにもキーの選択には気をつけるようにアドバイスをいただきました。ありがとうございます。ということで、上矢印（Up)ではなくF9で試してみたところ正常に動くようになりました。
</p><p>
失敗と回り道をしましたがノウハウと経験を積むことができました。これが足りないとすぐ手も足も出なくなります。大事です。
</p>
<h2>４　さらに工夫の方法</h2>
<p>
さて前回、疲労軽減にためにモニターの端にぶつかったらカーソルが方向転換して戻って来る工夫についてお話しました。みなさんにも考えていただけたでしょうか。実はやり方が何通りかあるようです。ちなみに私は次のように作ってみました。
</p><p>
mouse6bb.ahk
<pre class="brush: js;">
SysGet, VirtualScreenWidth, 0
SysGet, VirtualScreenHeight, 1
Speed:=20
Count:=0

F9::
Count++
If Count = 1
{
  X:=0
  Y:=-2
}
Else If Count = 2
{
  X:=2
  Y:=0
}
Else If Count = 3
{
  X:=0
  Y:=2
}
Else If Count = 4
{
  X:=-2
  Y:=0
  Count:=0
}
Sleep, 100
Loop
{
MouseMove, X, Y, Speed, R
if GetKeyState("F9", "P") = 1
Break
CoordMode,Mouse,Screen
MouseGetPos, xpos, ypos 
if ((xpos = 0) or (ypos = 0) or (xpos = VirtualScreenWidth - 1) or (ypos = VirtualScreenHeight - 1))
{
X:=X*-1
Y:=Y*-1
}
}
Return
</pre>
</p><p>
説明<br>
前回のサンプルに1-2行目、35-41行目を追加しました。<br>

また、6行目33行目、操作に使用するキーをこれまでの上矢印(Up)をF9に変更しています。<br>

1-2行目　ここで使用しているモニタの幅と高さを求めます。単位はドットです。幅はVirtualScreenWidth、高さは　VirtualScreenHeight　になります。<br>

35,36行目で、マウスカーソルの座標を求めます。単位はドットです。原点はモニタの左上で右方向にX軸、下方向にY軸です。X座標値をxpos、Y座標値をyposになります。<br>
（注意：複数のモニタを使用している場合は、第一（プライマリ）モニタの左上が原点になります。そのほかのモニタの配置により座標値の値の範囲が決まりますのでご注意ください）<br>
37行目でモニタの端に来ているかを判定して、移動速度、XとYの値を変更しています。<br>

これだけのことを9行追加で作ることができました。AutoHotkeyはなかなか侮れません。

</p><p>
実際に試してみたい方は、
<a target="_blank" href="http://www.toyama-reha.or.jp/techno/engineering/mouse/mouse6bb.exe">常駐型実行ファイル、mouse6bb.exe　をこちらから</a>
ダウンロードしてください。ダブルクリックで動作を開始します。終了するときはタスクトレイ（通知領域、画面右下の部分）のＨのアイコンを右クリックしてEXITしてください。
</p>
<h2>５　まとめ</h2>
<p>
今回はゲームパッドを使ってAutoHotkeyで作ったマウスを動かす方法についてお話しました。この方法を発展させゲームパッドに改造を加えると、ジェリービーンスイッチなどの外部スイッチでもマウスが操作できるようになり、さらに重い不自由をもつ人の可能性を広げることができるようになります。
</p><p>
また使う人に合わせた工夫や改善がいろいろできることもおわかりいただいたと思います。
</p><p>
自分にはできないとおっしゃる方々、そう信じている人たちに取り組んでいただくにはいろいろと準備も仕込みも必要なのです。しかしやることをやれば必要以上にむやみにあきらめることはないのです。
</p>

<h2>関連するページ</h2>

<ul>
  <li><a href="../kousaku/gamepad.html" target="_self">ゲームパッドで作るパソコン入力装置</a>
</li>
  <li><a href="../etc/howtomakemp32.html" target="_self">ゲームパッドを活用しよう　JoyToKeyの役割とantiMicroの紹介</a>
</li>
  <li><a href="../etc/howtomakemp3.html" target="_self">小型の携帯音楽プレーヤはどうも使いにくい　古いWindowsノートパソコンで音楽プレーヤをつくる方法</a>
</li>
</ul>

<h2>参考URL</h2>
<p>AutoHotkey　関係
<ul>
  <li>AutoHotkey　（本家　英語です）ダウンロードはこちらから<br>
<a target="_blank" href="https://www.autohotkey.com/">https://www.autohotkey.com/</a></li>

  <li>AutoHotkey　WIKI 　（日本の分家です）使い方マニュアル一覧<br>
<a target="_blank" href="http://ahkwiki.net/Top">http://ahkwiki.net/Top</a></li>

  <li>AutoHotkeyの評価・使い方 - フリーソフト100　基本的な解説　使い方など<br>
<a target="_blank" href="https://freesoft-100.com/review/autohotkey.html">https://freesoft-100.com/review/autohotkey.html</a></li>

  <li>AutoHotkey - ウィキペディア<br>
<a target="_blank" href="https://ja.wikipedia.org/wiki/AutoHotkey">https://ja.wikipedia.org/wiki/AutoHotkey</a></li>
</ul>

<hr style="width: 60%; height: 5%; color: black;">
<p><span class="samples">2020/01/10　公開<br>
</span></p>

<a href="../index.html" target="_self">
<p align="center">研究企画課リハ工学科にもどる</a>　←もくじはこちらです</p>

</body></html>
