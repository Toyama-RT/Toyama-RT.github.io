<!DOCTYPE html>
<html lang="ja"><head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-82832782-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-82832782-3');
</script>

  <meta content="text/html; charset=utf-8" http-equiv="content-type">

  
  <script type="text/javascript" src="../sh/scripts/shCore.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushXml.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushPlain.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushJScript.js"></script>
  
  <script type="text/javascript" src="../sh/scripts/shBrushVb.js"></script>
  
  <link type="text/css" rel="stylesheet" href="../sh/styles/shCoreDefault.css">

  
  <script type="text/javascript">SyntaxHighlighter.all();</script>
  <title>Web 文字盤4｜富山県リハ病院こども支援センター</title>
  
  <style type="text/css">
<!--
      
p	{
      font-size: 20px;
      line-height : 1.75 ;
      margin: 15px 100px 15px 100px;
	}
h1 {
    text-align: center;
    }
h2 {
    text-align: left;
      margin-left: 100px;
    }
h3 {
    text-align: left;
      margin-left: 100px;
    }
h4 {
    text-align: left;
      margin-left: 120px;
    }
pre {
    font-size: 20px;
    margin: 5px 100px 15px 100px;
    }
address{
	margin:5px 100px 15px 100px;
}      
blockquote {
    position: relative;
      font-size: 20px;
      line-height : 1.5 ;
    padding: 5px 150px 8px 100px;
    box-sizing: border-box;
    font-style: italic;
}
ol {
}
ul {
}
li {
  margin-top: 5px; /* 上余白指定 */
  margin-bottom: 5px; /* 下余白指定 */
  margin-left: 100px; /* 左余白指定*/
  margin-right: 100px; /* 右余白指定 */
  font-size: 20px; /*リストのフォントの大きさ*/
}
button{
  margin-bottom:1rem;
  width:150px;
  height:100px;
}

span.samples {font-size: small; }
.syntaxhighlighter {
  width: 80% !important;
  margin: 1em 100px 1em 100px !important;
  position: relative !important;
  overflow: auto !important;
  font-size: 1.3em !important;
}

    #text1 {
        width: 50%;
        height: 3em;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 3px;
        margin-bottom: 10px;
        font-size: 1.4em;
        font-weight: 700;
    }
    #btn1 {
        background: -webkit-linear-gradient(top,#008dfd 30%,#0370ea 100%);
        color: white;
        text-shadow: 1px 1px 1px #076bd2;
        border-radius: 3px;
        border: 1px solid #076bd2;
        padding: 2px 25px;
        font-weight: 700;
        font-size: 20px;
    }
    #selectVoice1 {
        width: 200px;
        font-weight: 700;
        font-size: 20px;

    }
    #text2 {
        width: 50%;
        height: 3em;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 3px;
        margin-bottom: 10px;
        font-size: 1.4em;
        font-weight: 700;
    }
    #btn2 {
        background: -webkit-linear-gradient(top,#008dfd 30%,#0370ea 100%);
        color: white;
        text-shadow: 1px 1px 1px #076bd2;
        border-radius: 3px;
        border: 1px solid #076bd2;
        padding: 2px 25px;
        font-weight: 700;
        font-size: 20px;
    }
    #selectVoice2 {
        width: 200px;
        font-weight: 700;
        font-size: 20px;

    }
    #text3 {
        width: 50%;
        height: 3em;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 3px;
        margin-bottom: 10px;
        font-size: 1.4em;
        font-weight: 700;
    }
    #btn3 {
        background: -webkit-linear-gradient(top,#008dfd 30%,#0370ea 100%);
        color: white;
        text-shadow: 1px 1px 1px #076bd2;
        border-radius: 3px;
        border: 1px solid #076bd2;
        padding: 2px 25px;
        font-weight: 700;
        font-size: 20px;
    }
    #selectVoice3 {
        width: 200px;
        font-weight: 700;
        font-size: 20px;
    }


-->
  </style>

</head><body>
<p align="center"><font size="5"><font size="5"><font size="3"><font color="#ff0000">かならずお読みください</font>→<a href="../cyuui.html" target="_self"><img alt="注意事項" src="../cyuuijikou.gif" border="0" height="29" width="78"></a></font></font></font></p>

<h1>Web 文字盤　４</h1>
<h1>オフラインWebアプリへの道</h1>

<div style="text-align: center;"><img alt="Web文字盤" src="img/offline.png" border="2"></div>

<p align="center">
<a target="_blank" href="https://youtu.be/2283TVf0e6U">youtubeの動画はこちら　26秒　音が出ます</a>
</p>

<h2>０　はじめに</h2>
<p>
エンチャント文字盤やWeb文字盤は、インターネットにつないで所定のページにアクセスすると利用できます。このようなアプリを「オンラインWebアプリ」または単に「Webアプリ」といいます。Webアプリはインストールなどの準備をしなくても手軽に使えますから複雑な操作が苦手な人でも助かります。またスマホでもパソコンでもタブレットでも同じように使えますし、これらのうちどれかを誰かからちょっと借りて試すこともできます。高価で特定の特別な機械や装置は必要ありません。身近にあるインターネットつながる道具でごく簡単に試してみることができます。パソコンでもタブレットでもスマホでも自分の好きなものを選べます。
</p><p>
日頃からスマホやパソコンでホームページ閲覧をしている人にとってこれは何の苦労もない簡単な作業です。今頃の高校生、中学生そして小学生の多くも何の苦労もなくこれができるでしょう。つまりこれは使い始めるまえに準備しておくこと学習しておくことがとても少ないということです。また使っていてわからないことがあっても近くの誰かに聞けばすぐわかります。何しろ日本国民の7割がもうすでにスマホを持っています。つまりちいさな赤ちゃんとご高齢の方以外はほとんどもっていることになります。こんなところがWebアプリの一番の特徴です。
</p><p>
ただしひとつだけ条件があります。それは、『インターネットがあれば』のはなしです。
</p><p>
ある研修会で、エンチャント文字盤のお話をしました。案の定そのあとの質問コーナーで、
<br>
「私の担当している方の家にはインターネットがないのですが　　」
<br>
と質問がありました。これに対して次のように返事をしました。
</p><p>
「インターネットが繋がっていないときでも使用できる技術が実用化されています。その問題は近々解決されるでしょう」
</p><p>
「オフラインWebアプリ」と呼ばれているこの技術の話を今回しましょう。
</p><p>
それにしてもオフラインWebアプリ？？これは変な名前ですね。まるで「電気なし電気自動車」のようになんだか矛盾していますね。なんでこうなったのかは謎ですがまああまり気にせずに話をすすめることにします。

</p>
<h2>１　インターネットとオフラインアプリ</h2>
<p>
オフラインWebアプリについてはこれまで二回話題にとりあげています。
<br>
一回目は、
<a href="../enchant/enchant5.html" target="_self">実験　インターネットなしでエンチャント文字盤ができるか</a>　（2018/2/23　公開）&nbsp;で
<br>
二回目は、<a href="../33reha_serviceworker.pdf" target="_self">オフライン機能付きエンチャント文字盤の開発</a>　を公開しました。（2018/12/26）でした。
</p><p>
オンラインWebアプリとオフラインWebアプリの違いを理解するためには、インターネットの原理から理解する必要があります。ごくごく簡単にお話ししますのでおつきあいください。
</p><p>
ますインターネットでホームページを閲覧するためには（いま閲覧しているこのページも同じ原理です）
パソコンやスマホからページの基本設計図とも言える、htmlファイルを送ってくれるようにインターネットにリクエストを送ります。これに応えてまず基本設計図が届きます。続いて部品として、画像ファイルや音声ファイル、デザインのcssファイル、動作プログラムのJavaScriptファイルなどがインターネットを通じて手元の機械にとどいて画面が表示されます。
</p><p>
とどいたファイルは使われたあと異なるページを行き来したときに素早く切り替わるようにしばらくの間保存されますが有効期限が切れると自動的に消去されます。そしてインターネットが途切れるとこのページのトップのような画面が出るようになります。

これはリクエストを出してもインターネットから返事が来ない状態です。こうなったらどうしたらいいでしょう？
</p><p>
その答はこうです。インターネットにつながっているときに届いたファイルをあらかじめ別の場所に保存しておいて、インターネットにつながっていないときに必要になったら保存場所から取り出してくれるプログラムを作り動かせばいいのです。やるべき事を文字にすればこれだけですが、実際作るための勉強にはすこし時間がかかります。
</p>
<h2>２　お試しの手順</h2>
<p>
上の動画と同じ事をお手元で再現してみましょう。
</p><p>
準備するもの　Windows10でパソコンと使用するブラウザ（インターネット閲覧ソフト）はMicrosoftEdgeをお使いください。また、読み込むページはこちらです。
<br>
<a href="https://toyama-rt.github.io/web-mojiban/hcjhk70t1/hcj.html" target="_blank">50音文字盤　四種類文字盤切り替え　10種類の文書切り替え、文書保存機能付き　4:3モニター用　オフラインWebアプリ機能付き</a>
<br>
これを開くと表示され、きちんと動作します。なんの変哲も（？）ありません。ここでいったんこのページをブックマークしておきます。
</p><p>
そしてブラウザを閉じます。ここでインターネットを遮断します。方法は、LANケーブルを抜く、wifiスイッチをオフにする、機内モードにする、ルーターの電源を切る（事前に周囲の皆さんの同意が必要でしょう）などおまかせします。
</p><p>
ここで10分以上待ちます。通常はこの程度で保存されたファイルの有効期限が切れて消去されます。コーヒータイムには程よい時間です。
</p><p>
ここで再びブラウザを立ち上げます。インターネットにつながっていませんので、普通はこのページトップのような画面が表示されます。（ニュースサイトのトップページはキャッシュの有効時間が比較的長く設定されていますので元通りに表示されることもあります。この場合はもっと待つか、キャッシュを削除しましょう）
</p><p>
さあここでブックマークから所定のページを開くとオフラインなのにオンラインと同じく表示され使用できます。すでに必要なファイルは保存されているからです。
</p><p>
このパソコンをインターネットの入っていないお家に持って行っても使えます。ネットの使えない外出先でも、ネットを使っちゃいけない機内でも使用することができるようになります。
</p><p>
これが、オフラインWebアプリで、これが先ほど紹介したの質問の答になります。
</p>
<h2>３　おわりに</h2>
<p>
インターネットが使えない場所でも利用できる機能を開発しWeb文字盤につけました。（このページトップのサンプル動画ではさらに合成音声を用いた任意文字列の読み上げ機能もついています。まだテスト中です。）
</p><p>
これはオフラインWebアプリとして近年注目を集めている機能です。このほかにプログレッシブWebアプリとかサービスワーカとかいくつかの名前で呼ばれている技術を応用して実現しました。
</p><p>
2017年の冬に勉強を開始し、翌春に初めてのサンプルを作り、夏に原理と効果を発表しました。ここまででうまくいけばなんとかなることがわかりましたので、続いてどうやればうまくいくのか、うまくいかないのかを時間をかけて調査してきました。そしてようやく狙ったことがいくらか実現できるようになりまた失敗も少なくなってきました。まあそろそろ習熟がすすんできただろうかと思っています。
</p><p>
また今回のオフラインWebアプリの作成にあたり、Chrome　Firefox　Edge　の三種類のブラウザをテストと改良に使用しました。しかしその結果、Chromeは音声ファイル（mp3）の保存する部分でうまく動作していないらしいこと、そしてFirefox は起動段階でうまくいっていないらしいことがわかって来ました。その一方でEdgeでは、現状でこのような問題もなく、狙ったとおりに動作することがわかりました。公式にはどのブラウザもサービスワーカには対応しているとされていますが、もうすこし改良が必要なのかもしれません。いずれにせよオフラインWebアプリの技術は、
</p>
<ol>
<li>インターネットが世の中の隅々までゆきわたるまでのつなぎとして</li>
<li>不安定な通信事情を回避する手段として</li>
<li>通信コストの節約と表示速度の向上の手段として</li>
</ol>
<p>
有望ですので、今後も開発が継続して進められこれらの不具合もまもなく改善されるだろうと予想しています。
</p><p>
さてこのようにしてインターネットは使えなくてもWeb文字盤が使えるようになりました。これによって使う人の自由と選択肢がまた少し広がりました。
</p><p>
しかしここで注意が必要です。インターネットなしで使えるのだからこれでインターネットは必要ないと考えていませんか？ちょっとまってください。その考えは使う人の自由と選択肢を狭めていないでしょうか。
</p><p>
インターネットを利用すれば外出中の家族と連絡がとれます。多くの人とつながります。読むもの、見るものなど多くのコンテンツも利用できます。多くのサービスを自分で利用できます。
</p><p>
できないこともあるでしょうが、できることもいろいろあります。
</p><p>
とかくコミュニケーション支援の場面では、コミュニケーションの実現に気を取られがちですが、その向こうにそのひとの生活の広がりがあることを忘れないように気をつけるべきだと思います。

</p>
<h2>関連する話題</h2>

<ul>
  <li><a href="./web-mojiban1.html" target="_self">Web　文字盤　１　Android の EVA Facial Mouse でも使えます</a>
</li>
  <li><a href="./web-mojiban2.html" target="_self">Web　文字盤　２　ワイドモニターでの見やすさを改善しました</a>
</li>
  <li><a href="./web-mojiban3.html" target="_self">Web　文字盤　３　あいさつ文字盤とからだ文字盤を追加しました</a>
</li>
  <li><a href="./web-mojiban5.html" target="_self">Web　文字盤　５　文章読み上げ機能を追加しました</a>
</li>
  <li><a href="./web-mojiban6.html" target="_self">Web　文字盤　６　読み上げ機能付きWeb文字盤にオフラインWebアプリ機能をつけました</a>
</li>
  <li><a href="./web-mojiban7.html" target="_self">Web　文字盤　７　オフラインWebアプリ　通常の使い方とインストールアンインストールの方法</a>
</li>
  <li><a href="./web-mojiban8.html" target="_self">Web　文字盤　８　番外編　パソコンとAndroidにおけるJavaScriptの違いと不具合の対策</a>
</li>
  <li><a href="./web-mojiban9.html" target="_self">Web　文字盤　９　タブレットの準備OK</a>
</li>

</ul>

<h2>参考URL</h2>
<p>ブラウザのキャッシュ　関係
<ul>
  <li>キャッシュとは？IT初心者でも分かるように解説<br>
<a target="_blank" href="https://saruwakakun.com/it/web/cache">https://saruwakakun.com/it/web/cache</a></li>
  <li>キャッシュについて整理 - Qiita<br>
<a target="_blank" href="https://qiita.com/anchoor/items/2dc6ab8347c940ea4648">https://qiita.com/anchoor/items/2dc6ab8347c940ea4648</a></li>
  <li>キャッシュの有効期限をチェックしてWebサイト表示の高速化に役立てよう<br>
<a target="_blank" href="https://www.imamura.biz/blog/24300">https://www.imamura.biz/blog/24300</a></li>

</ul>

<p>Progressive Web Apps　関係
<ul>
  <li>Progressive Web Apps  Web Google Developers<br>
<a target="_blank" href="https://developers.google.com/web/progressive-web-apps/">https://developers.google.com/web/progressive-web-apps/</a></li>

  <li>はじめてのプログレッシブ ウェブアプリ<br>
<a target="_blank" href="https://developers.google.com/web/fundamentals/codelabs/your-first-pwapp/?hl=ja">https://developers.google.com/web/fundamentals/codelabs/your-first-pwapp/?hl=ja</a></li>

</ul>

<hr style="width: 60%; height: 5%; color: black;">
<p><span class="samples">2019/07/26　公開</span></p>

<a href="../index.html" target="_self">
<p align="center">研究企画課リハ工学科にもどる</a>　←もくじはこちらです</p>

</body></html>
